📍[Stateless와 Token](#stateless와-token)   
📍[쿠키](#쿠키)   
📍[세션](#세션)   
    - [세션 구조](#세션-구조)  
📍[쿠키와 세션의 사용 예](#쿠키와-세션의-사용-예)  

### Stateless와 Token

로그인 기능을 구현하려 하는데 ‘무상태’ 일 경우?  
서버에서 클라이언트(웹브라우저) 정보를 기억하고있지 않기 때문에, 로그인 기능은 ‘무상태'로 구현이 어려움 😖  
이때 중간다리 역할인 `JWT 토큰`이 필요💡  
· JWT 토큰 : stateless의 특징을 유지하면서도 로그인 상태 유지를 가능하게 하는 기술

이 외에도 로그인 인증 방식에 `쿠키`, `세션` 이라는 개념 존재


# 🍪 쿠키와 세션

쿠키, 세션은 웹 애플리케이션에서 `사용자 인증` 및 `상태 유지`를 위해 사용되는 두 가지 주요 메커니즘  
두 가지는 각각 고유한 특징과 용도를 가지고 있음  
사용자의 경험을 향상시키기 위해 적절하게 선택하여 사용 가능함 

## 쿠키

`클라이언트 측에 정보를 저장`하는 방법  
클라이언트의 브라우저에 설치되는 `Key-Value 형식`의 작은 데이터 파일  
클라이언트가 웹사이트를 방문할 때마다 `HTTP 헤더`에 포함되어 전송됨

#### <특징>
- **크기 제한**: 최대 4KB의 크기
- **전송 속도 빠름**:  클라이언트 측에 저장되며, HTTP 요청과 함께 전송되므로 전송 속도가 빠름
- **보안적인 문제**: 클라이언트의 웹 브라우저에 저장되기 때문에 변조될 가능성이 있으며, XSS 공격 등에 취약

#### <인증 방식>
1. 클라이언트가 서버에 요청을 보내면, 서버는 클라이언트에게 저장하고 싶은 정보를 `Set-Cookie`헤더에 담아 응답
2. 클라이언트는 이후 요청을 보낼 때마다 해당 쿠키를 요청 헤더의 `Cookie`에 담아 서버로 전송
3. 서버는 쿠키에 담긴 정보를 바탕으로 클라이언트 식별
    ![쿠키 인증 방식](https://images.velog.io/images/ssssujini99/post/c27d340f-714c-49ee-b34c-b351830fc329/image.png)   


#### <사용 예>
- **로그인 상태 유지**: 사용자가 로그인한 상태를 유지할 수 있도록 쿠키를 사용하여 세션 정보 저장  
- **개인화**: 사용자의 선호도(ex 언어 설정, 글꼴 크기 등)를 저장하여 다음 방문 시 동일한 설정 유지
- **트래킹 및 광고**: 사용자의 웹사이트 활동을 추적하여 맞춤형 광고 제공  

## 세션

`서버 측에 정보를 저장`하는 방법  
세션 데이터는 서버의 메모리나 데이터베이스에 저장됨  
클라이언트와의 연결을 통해 상태 유지  

#### <특징>
- **크기 제한 ❌**: 서버에 저장되기 때문에 크기에 제한 없음
- **전송 속도**: 서버에서 데이터를 가져와야 하기 때문에, 쿠키에 비해 전송 속도가 느림
- **보안성**: 서버에 저장되므로 변조나 도난의 위험 낮음

#### <인증 방식>
1. 사용자가 웹사이트에 로그인하면, 서버는 세션 데이터 생성 및 데이터베이스에 저장  
  (세션을 식별하기 위한 `Session ID`가 생성됨)
2. 서버는 클라이언트의 쿠키에 `Session ID `저장  
  ➡️ 이후 클라이언트는 모든 요청에 해당 `Session ID`를 포함하여 전송
3. 서버는 클라이언트로부터 받은 `Session ID`를 기반으로 저장된 세션 데이터를 조회하여 클라이언트 인증
    ![세션 인증방식](https://mblogthumb-phinf.pstatic.net/MjAyMjExMTVfNDgg/MDAxNjY4NTA4NTEyODc3.n4bFFcHi9cNDUkUr9oTqPkgCCN7m121WiBf1dW5BQecg.VBNiIcmJg_msBRw-XJgrTU2bIVaU9Mhzz1IboGFihKog.PNG.hj_kim97/Session.png?type=w800)   


#### <사용 예>
- **로그인 상태 유지**: 사용자가 로그인한 상태를 서버 측에서 유지하여, 세션 만료 전까지 지속적으로 인증된 상태 유지 가능
- **장바구니 정보 저장**: 전자상거래 사이트에서 사용자의 장바구니 정보를 서버 측에 저장하여, 사용자가 다른 페이지로 이동해도 장바구니 정보 유지 가능


## 세션 구조
서버 측에서 클라이언트의 상태를 관리하기 위한 데이터 저장 방식
`해시맵` 개념이 자주 사용됨
> **해시맵** : 키-값 쌍을 효율적으로 저장하고 조회할 수 있는 자료 구조  
   ➡️ 세션 관리에 적합

#### <세션의 구성 요소>
- `세션 ID (Session ID)`
    -   클라이언트와 서버 간의 세션을 식별하기 위한 고유한 식별자  
    -   주로 `랜덤`하게 생성되며, 클라이언트의 `쿠키`에 저장됨
- `세션 데이터`
    - 사용자의 상태 정보를 저장하는 데이터
    -  로그인 정보, 사용자 설정, 장바구니 정보 등 포함
 
#### <세션 관리 과정>
- **세션 생성**: 클라이언트가 처음 서버에 접속하거나 로그인할 때, 서버는 새로운 세션을 생성하고 고유한 세션 ID를 발급  
  (해당 세션 ID는 클라이언트의 `쿠키`에 저장됨)
- **세션 저장**: 세션 ID를 키로 하여, 서버의 메모리 or 데이터베이스에 세션 데이터를 저장  
  (`해시맵` 사용) 
- **세션 조회**: 클라이언트가 서버에 요청을 보낼 때마다, 세션 ID가 포함된 쿠키를 전송  
 ➡️ 서버는 세션 ID를 이용해 `해시맵`에서 세션 데이터를 조회하고, 클라이언트의 상태를 유지
- **세션 만료**: 일정 시간 동안 활동이 없거나 명시적으로 로그아웃할 경우, 세션이 만료됨 ➡️ 만료된 세션 데이터는 서버에서 삭제

#### <해시맵과 세션>  
`해시맵`은 세션 관리에 자주 사용되는 자료 구조  
 해시맵은 `키-값`쌍 으로 데이터를 저장하며, 키를 이용해 값에 빠르게 접근 가능!  
 
**세션 관리에서 해시맵의 역할**  
- 세션 ID를 `키`로 사용하고, 세션 데이터를 `값`으로 저장  
- 빠른 조회가 가능하여, 클라이언트의 요청에 대해 신속하게 응답 가능
- 효율적인 관리가 가능하여, 세션 CRUD 작업을 효과적으로 수행 가능

![세션 구조](https://t1.daumcdn.net/tistoryfile/fs5/9_21_33_33_blog120368_attach_0_1.bmp?original)   

## 쿠키와 세션의 사용 예
상황에 따라 적절한 방식으로 선택하여 사용
#### 1. 로그인 상태 유지
- **쿠키**: 사용자가 로그인할 때 서버가 발급한 쿠키에 사용자 정보를 저장하여, 사용자가 다른 페이지로 이동해도 로그인 상태 유지
- **세션**: 로그인 시 서버가 발급한 Session ID를 클라이언트의 쿠키에 저장하고, 서버 측에서 세션 데이터를 관리하여 로그인 상태 유지

####  2. 장바구니 정보 저장
- **세션**: 사용자가 상품을 장바구니에 추가할 때 세션에 정보를 저장하여, 이후 방문 시에도 동일한 장바구니 상태 유지

#### 3.개인화
- **쿠키**: 사용자가 웹사이트에서 선호하는 설정(예: 언어, 테마 등)을 쿠키에 저장하여, 다음 방문 시 자동으로 적용
